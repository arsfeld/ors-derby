<h1>derby-i18n</h1>
<p>Simple filesystem-based i18n support for <a href="http://derbyjs.com">derby</a>, a node.js MVC framework. It is planned to support interpolation and plurals in the near future.

</p>
<h2>Getting Started</h2>
<h4>Install in your app directory</h4>
<p><code>npm install derby-i18n</code>

</p>
<h4>Add locale files</h4>
<p>By default, derby-i18n looks for locales in <code>locales/[language-code]/[app-name].json</code>.
For example, if you have an app called &quot;blog&quot;, and your app supports english, you&#39;ll
have locale files at <code>locales/en/blog.json</code>. Heres a sample blog.json file to get you started:

</p>
<pre><code class="lang-javascript">{
    &quot;title&quot;: &quot;JKN&quot;
    &quot;article&quot;: {
        &quot;published_on&quot;: &quot;Published on the&quot;,
        &quot;meta&quot;: &quot;Read more and comment&quot;
    }
}</code></pre>
<h4>Localize your app object</h4>
<p>In your app.js, you&#39;ll need to call derby-i18n&#39;s <code>localize</code> method on your app:

</p>
<pre><code class="lang-javascript">var derby = require(&#39;derby&#39;),
    i18n = require(&#39;derby-i18n&#39;),
    app = i18n.localize(derby.createApp(module), {
        availableLocales: [&#39;en&#39;, &#39;ja&#39;],
          urlScheme: &#39;path&#39;
    });</code></pre>
<p>There are a number of options available for localize, but if you don&#39;t pass it any
options it will assume you just want English. This is really simple way to build
in support for other languages from the beginning!

</p>
<h4>Localize your views</h4>
<p>derby-i18n adds a few view helpers for you to use, including:

</p>
<ul>
<li><p><code>t(key)</code></p>
<p>Returns the translation for the given key. For example, to display the published_on
key in the above locale file, you would do <code>{{t(&quot;article.published_on&quot;)}}</code>.</p>
<p>Support is planned for pluralization and interpolation in the near future.</p>
</li>
<li><p><code>localizedPath(path)</code></p>
<p>If using the <code>path</code> urlScheme, this will return the given path with <code>/[locale]/</code> prepended to it - for example <code>/en/</code> for the English locale. If not using the <code>path</code> urlScheme, nothing happens. This is useful for making sure your URLs are always pointing at the correct language.</p>
</li>
</ul>
<p>derby-i18n also sets an <code>_i18n</code> field on your model:

</p>
<pre><code>model.set(&#39;_i18n&#39;, {
    locale: locale,
    language: language,
    region: region,
    namespace: o.ns
});</code></pre>
<p>The locale attribute includes the region if it is supported, otherwise just the language. The namespace is just the name of your app (<code>blog</code> in the above example).


</p>
<h2>Options</h2>
<p>Configuration is accomplished by passing options to the localize call which wraps your app. The available options include:

</p>
<ul>
<li><p><code>urlScheme</code></p>
<p>Currently, the only supported options are <code>&quot;path&quot;</code> and <code>false</code>. Support for <code>&quot;domain&quot;</code> is also planned.</p>
<p>When set to <code>&quot;path&quot;</code>, the first place to look for a locale is the first part of the current URL. For example, if the URL is <code>/ja/ongaku/capsule</code>, then your locale will be <code>ja</code>. Regions are also supported, for example <code>/en-US</code>.</p>
<p>When set to <code>false</code>, URLs will be ignored as a source of locale information.</p>
</li>
<li><p><code>availableLocales</code></p>
<p>An array containing the available locales for your app. Defaults to <code>[&quot;en&quot;]</code>.</p>
<p>This should mirror the locales available in your <code>/locales</code> directory. If a locale is requested in a URL and isn&#39;t in this list, a 404 exception will be thrown.</p>
</li>
<li><p><code>checkHeader</code></p>
<p>If <code>true</code>, the http accept-language header will be checked for a locale in the case that one isn&#39;t available in the URL. If the language-region combination is available, that will be used. Failing that, if a locale is defined for the same language without a region attached, that will be used. Otherwise the default locale is used.</p>
</li>
<li><p><code>defaultLocale</code></p>
<p>The locale which will be chosen if one can&#39;t be found in the URL or headers. Defaults to the first locale in the <code>availableLocales</code> option.</p>
</li>
<li><p><code>forceScheme</code></p>
<p>When <code>urlScheme</code> is <code>&quot;path&quot;</code>, URLs which don&#39;t match this regex will have the locale
prepended to the URL in a redirect. URLs which do match it and don&#39;t contain a locale will 404. By default, matches everything over than <code>/</code>.</p>
</li>
<li><p><code>backend</code></p>
<p>Defaults to a filesystem backend, but it should be possible to create others, like one based on the MongoDB store.</p>
</li>
</ul>
<h2>Credits</h2>
<ul>
<li>Nate Smith and Brian Noguchi6 - creators of <a href="http://derbyjs.com">derby</a></li>
<li><a href="https://github.com/jamuhl">Jan MÃ¼hlemann</a>, creator of <a href="http://i18next.com">i18next</a> (which derby-i18n has borrowed from in places)</li>
</ul>
